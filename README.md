# Home Control

Home Control is a simple application created to monitor Linux servers on a
local network. The idea is to have a small, power efficient machine (such as a
Raspberry Pi) act as a hub so you can leave your more powerful and power-hungry
machines powered off until you need them.

## Features

* Monitoring: Home Control allows you to easily see the server status, its MAC
address, and IP address.

* Power On: Home Control allows you to power your machine on by sending a magic
packet via wakeonlan. This must be configured on your machine, both in the BIOS
and in the OS. See [this how-to from Ubuntu](https://help.ubuntu.com/community/WakeOnLan)
to get an idea of how to enable it within Linux. The process should be similar
for most distros.

* Restart/Shut Down: Home Control allows for remote restarting and powering off
of your machines. You must install add-on [Home Control Monitor](https://github.com/jessereitz/home-control-monitor)
on the machine for which you would like to enable this functionality. See the
Home Control Monitor page for more information.

## Installation

For now, Home Control Monitor must be installed manually. This will hopefully
be updated to be available as a Linux Snap in the near future.

Before you get started, you will need sqlite3 installed, if you don't already
have it. If you're on a Debian/Ubuntu system, simply run
`$ sudo apt install sqlite3`.

Once you have that taken care of, follow these steps:

1. Download the Home Control Monitor source files via a git clone or grab the
latest release here on the repo. For the easiest installation, I recommend
placing the directory in `/usr/local/bin` as this is what the included service
unit file will expect. You can change this if you wish, just be sure to edit the
`home-control.service` file to match what your preferred location.
```shell
    $ sudo git clone https://github.com/jessereitz/home-control.git /usr/local/bin/home-control
```

2. Install dependencies via npm from the home-control directory.
```shell
    $ npm install
```

3. Run the initialization script from the home-control directory. This
will walk you through creating a user database and a user account (see below),
creating a configuration file to keep track of which servers to monitor,
and will copy the service unit file to `/etc/systemd/system` and enable/start
the service. (This must be done as sudo in order to copy the `.service` file
into `etc/systemd/system` and enable/start the service)
```shell
    $ sudo npm run initialize
```

4. You should be all set to go! You can browse to `http://localhost:9070` to see
Home Control in action.

Once the initialization process has been completed there will be a
`server-config.json` file in the home-control directory. It will look something
like this:

```JSON
{
  "_meta": {
    "info": "This file was autogenerated by Home Control. You can add or delete servers in the 'servers' array below.",
    "created": "18/11/2018, 21:14:24"
  },
  "servers": [
    {
      "name": "Example Server",
      "ip": "192.168.51.156",
      "mac": "32:9b:20:ad:4b:63"
    }
  ]
}

```

### Adding Accounts and Servers

If you would like to add another user or if you
forget your username/password, run the create-user script:
```shell
$ npm run create-user
```

If you would like to add another server to monitor, you can add it directly in
the `server-config.json` file located in the home-control directory or run the
add-server script from the directory:
```shell
$ npm run add-server
```
